apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
  namespace: media-gateway-prod
  labels:
    app: media-gateway
data:
  # Service Discovery URLs
  API_GATEWAY_URL: "http://api-gateway.media-gateway-prod.svc.cluster.local:8080"
  DISCOVERY_SERVICE_URL: "http://discovery-service.media-gateway-prod.svc.cluster.local:8081"
  SONA_ENGINE_URL: "http://sona-engine.media-gateway-prod.svc.cluster.local:8082"
  SYNC_SERVICE_URL: "http://sync-service.media-gateway-prod.svc.cluster.local:8083"
  AUTH_SERVICE_URL: "http://auth-service.media-gateway-prod.svc.cluster.local:8084"
  INGESTION_SERVICE_URL: "http://ingestion-service.media-gateway-prod.svc.cluster.local:8085"
  MCP_SERVER_URL: "http://mcp-server.media-gateway-prod.svc.cluster.local:3000"

  # Feature Flags
  ENABLE_RATE_LIMITING: "true"
  ENABLE_CACHING: "true"
  ENABLE_METRICS: "true"
  ENABLE_TRACING: "true"
  ENABLE_DISTRIBUTED_TRACING: "true"
  ENABLE_CIRCUIT_BREAKER: "true"
  ENABLE_RETRY: "true"
  ENABLE_TIMEOUT: "true"

  # Rate Limiting Configuration
  RATE_LIMIT_REQUESTS_PER_SECOND: "100"
  RATE_LIMIT_BURST_SIZE: "200"
  RATE_LIMIT_WINDOW_SECONDS: "60"

  # Circuit Breaker Configuration
  CIRCUIT_BREAKER_FAILURE_THRESHOLD: "5"
  CIRCUIT_BREAKER_SUCCESS_THRESHOLD: "2"
  CIRCUIT_BREAKER_TIMEOUT_SECONDS: "30"
  CIRCUIT_BREAKER_HALF_OPEN_REQUESTS: "3"

  # Retry Configuration
  RETRY_MAX_ATTEMPTS: "3"
  RETRY_INITIAL_BACKOFF_MS: "100"
  RETRY_MAX_BACKOFF_MS: "5000"
  RETRY_MULTIPLIER: "2"

  # Timeout Configuration
  REQUEST_TIMEOUT_SECONDS: "30"
  CONNECT_TIMEOUT_SECONDS: "5"
  READ_TIMEOUT_SECONDS: "10"
  WRITE_TIMEOUT_SECONDS: "10"

  # Cache Configuration
  CACHE_TTL_SECONDS: "300"
  CACHE_MAX_SIZE_MB: "512"
  CACHE_EVICTION_POLICY: "lru"

  # Metrics Configuration
  METRICS_ENABLED: "true"
  METRICS_INTERVAL_SECONDS: "15"
  METRICS_HISTOGRAM_BUCKETS: "0.005,0.01,0.025,0.05,0.1,0.25,0.5,1,2.5,5,10"

  # Tracing Configuration
  TRACING_ENABLED: "true"
  TRACING_SAMPLE_RATE: "0.1"
  TRACING_SERVICE_NAME: "media-gateway"
  JAEGER_AGENT_HOST: "jaeger-agent.monitoring.svc.cluster.local"
  JAEGER_AGENT_PORT: "6831"

  # Logging Configuration
  LOG_LEVEL: "info"
  LOG_FORMAT: "json"
  LOG_OUTPUT: "stdout"

  # Database Configuration
  DB_POOL_SIZE: "20"
  DB_POOL_TIMEOUT_SECONDS: "30"
  DB_CONNECTION_TIMEOUT_SECONDS: "10"
  DB_IDLE_TIMEOUT_SECONDS: "300"
  DB_MAX_LIFETIME_SECONDS: "1800"

  # SONA Engine Configuration
  SONA_MAX_CONCURRENT_REQUESTS: "100"
  SONA_REQUEST_TIMEOUT_SECONDS: "60"
  SONA_BATCH_SIZE: "10"
  SONA_BATCH_TIMEOUT_MS: "100"

  # Sync Service Configuration
  SYNC_MAX_CONNECTIONS: "10000"
  SYNC_HEARTBEAT_INTERVAL_SECONDS: "30"
  SYNC_RECONNECT_INTERVAL_SECONDS: "5"
  SYNC_MESSAGE_BUFFER_SIZE: "1000"

  # Auth Configuration
  JWT_ALGORITHM: "RS256"
  JWT_EXPIRY_SECONDS: "3600"
  JWT_REFRESH_EXPIRY_SECONDS: "604800"
  JWT_ISSUER: "media-gateway"

  # Ingestion Configuration
  INGESTION_BATCH_SIZE: "100"
  INGESTION_BATCH_TIMEOUT_MS: "1000"
  INGESTION_MAX_FILE_SIZE_MB: "100"
  INGESTION_ALLOWED_FORMATS: "mp3,flac,wav,m4a,aac,ogg"

  # MCP Server Configuration
  MCP_TRANSPORT: "sse"
  MCP_MAX_CONNECTIONS: "1000"
  MCP_KEEPALIVE_INTERVAL_SECONDS: "30"
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
  namespace: media-gateway-staging
  labels:
    app: media-gateway
data:
  # Service Discovery URLs
  API_GATEWAY_URL: "http://api-gateway.media-gateway-staging.svc.cluster.local:8080"
  DISCOVERY_SERVICE_URL: "http://discovery-service.media-gateway-staging.svc.cluster.local:8081"
  SONA_ENGINE_URL: "http://sona-engine.media-gateway-staging.svc.cluster.local:8082"
  SYNC_SERVICE_URL: "http://sync-service.media-gateway-staging.svc.cluster.local:8083"
  AUTH_SERVICE_URL: "http://auth-service.media-gateway-staging.svc.cluster.local:8084"
  INGESTION_SERVICE_URL: "http://ingestion-service.media-gateway-staging.svc.cluster.local:8085"
  MCP_SERVER_URL: "http://mcp-server.media-gateway-staging.svc.cluster.local:3000"

  # Feature Flags (Staging - more permissive)
  ENABLE_RATE_LIMITING: "false"
  ENABLE_CACHING: "true"
  ENABLE_METRICS: "true"
  ENABLE_TRACING: "true"
  ENABLE_DISTRIBUTED_TRACING: "true"
  ENABLE_CIRCUIT_BREAKER: "false"
  ENABLE_RETRY: "true"
  ENABLE_TIMEOUT: "true"

  # Logging Configuration (Staging - more verbose)
  LOG_LEVEL: "debug"
  LOG_FORMAT: "json"
  LOG_OUTPUT: "stdout"
